@model MeePoint.Models.Group

@{
	ViewData["Title"] = "Details";
}
@Html.Partial("_BreadCrumb", @ViewData["Title"])

<!-- Small boxes (Stat box) -->
<div class="row">
	<div class="col-lg-3 col-6">
		<!-- small box -->
		<div class="small-box bg-info">
			<div class="inner">
				<h3>@Model.Name</h3>

				<p>Nome do Responsável: @Model.Entity.ManagerName</p>
			</div>
			<div class="icon">
				<i class="ion ion-bag"></i>
			</div>
			<a asp-controller="RegisteredUsers" asp-action="Details" asp-route-id="@Model.Entity.User.RegisteredUserID" class="small-box-footer">Ver Perfil do Responsável <i class="fas fa-arrow-circle-right"></i></a>
		</div>
	</div>
	<!-- ./col -->
	<div class="col-lg-3 col-6">
		<!-- small box -->
		<div class="small-box bg-success">
			<div class="inner">
				<h3>
					@{
						var firstDay = DateTime.Today.AddDays(-30);
						var countMeetings = Model.Meetings.Where(x => x.MeetingDate >= firstDay).Count();
					}
					@countMeetings
				</h3>

				<p>Reuniões efetuadas no último mês</p>
			</div>
			<div class="icon">
				<i class="ion ion-stats-bars"></i>
			</div>
			<a asp-controller="Groups" asp-action="History" asp-route-id="@Model.GroupID" class="small-box-footer">Ver o histórico de reuniões <i class="fas fa-arrow-circle-right"></i></a>
		</div>
	</div>
	<!-- ./col -->
	<div class="col-lg-3 col-6">
		<!-- small box -->
		<div class="small-box bg-warning">
			<div class="inner">
				<h3>@Model.Members.Count()</h3>

				<p>Participantes</p>
			</div>
			<div class="icon">
				<i class="ion ion-person-add"></i>
			</div>
			<a asp-controller="Groups" asp-action="Participants" asp-route-id="@Model.GroupID" class="small-box-footer">Ver Lista de Participantes <i class="fas fa-arrow-circle-right"></i></a>
		</div>
	</div>
	<!-- ./col -->
	<div class="col-lg-3 col-6">
		<!-- small box -->
		<div class="small-box bg-danger">
			<div class="inner">
				<h3>
					@{
						var nextMeetingDate = Model.Meetings.OrderByDescending(x => x.MeetingDate).Where(x => x.MeetingDate >= DateTime.Now).FirstOrDefault();
						string dateString;
						if (nextMeetingDate != null)
						{
							dateString = String.Format("{0:ddd d MMM }", nextMeetingDate.MeetingDate);
						}
						else
						{
							dateString = "Sem reuniões";
						}
					}
					@dateString
				</h3>

				<p>Próxima Reunião</p>
			</div>
			<div class="icon">
				<i class="ion ion-pie-graph"></i>
			</div>

			@if (nextMeetingDate != null)
			{
				<a asp-controller="Meetings" asp-action="Details" asp-route-id="@nextMeetingDate.MeetingID" class="small-box-footer">Ver Detalhes da Reunião <i class="fas fa-arrow-circle-right"></i></a>

			}
		</div>
	</div>
	<!-- ./col -->
</div>

<div>
	<h4>Group</h4>
	<hr />
	<dl class="row">
		<dt class="col-sm-2">
			@Html.DisplayNameFor(model => model.Name)
		</dt>
		<dd class="col-sm-10">
			@Html.DisplayFor(model => model.Name)
		</dd>
		<dt class="col-sm-2">
			@Html.DisplayNameFor(model => model.Entity)
		</dt>
		<dd class="col-sm-10">
			@Html.DisplayFor(model => model.Entity.Name)
		</dd>
	</dl>
</div>
<div>
	<a asp-action="Edit" asp-route-id="@Model.GroupID">Edit</a> |
	<a asp-action="Index">Back to List</a>
</div>